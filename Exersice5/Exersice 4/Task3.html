<!DOCTYPE html>
<html lang="en">
<head>
    
    <link href="Task3.css" rel="stylesheet">
    <title>T3 E4</title>
</head>
<body>
    <table>
        <tr>
            <td>
                <form  onsubmit="onFormSubmit()">
                    <div>
                        <label >FirstName</label>
                        <input type="text" name="productCode" id="fn">
                    </div>
                    <div>
                        <label >LastName</label>
                        <input type="text" name="product" id="ln">
                    </div>
                    
                    <div class="form_action--button">
                        <input type="submit" value="Add">
                        <input type="button"  value="render" onclick="renderdata()"/>
                    </div>
                </form>

                <td>
                    <table class="list" id="studentlist">
                        <thead>
                            <tr>
                                <th>FirstName</th>
                                <th>LastName</th>
                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </td>
            </td>
        </tr>
    </table>
</body>
<script>
    let Rowsel = null
    let isRender = true;

    let user = [
        {
            firstname : 'Dhrumil',
            lastname : 'Patel',
        },
        {
            firstname : 'Dhruvil',
            lastname : 'Modi',
        },
        {
             firstname : 'Rajdeep',
             lastname : 'solanki',
        },
        {
             firstname : 'Kundan',
             lastname : 'Thakor',
        },
        {
             firstname :'Dhruvil',
             lastname : 'Yamulewar',
        },
        {
             firstname : 'Dhruv',
             lastname : 'Patel',
        },
        {
             firstname :'Abc',
             lastname : 'def',
        },
        {
             firstname : 'Hil',
             lastname : 'Klm',
        },
    ];
    let selectedRow = null

        function onFormSubmit(e) 
        {
	    event.preventDefault();
        let formData = readFormData();
        if (selectedRow == null){
            insertNewRecord(formData);
		}
        else{
            updateRecord(formData);
		}
          
       }

           //Retrieve the data
      function readFormData() 
      {
    let formData = {};
    formData["productCode"] = document.getElementById("fn").value;
    formData["product"] = document.getElementById("ln").value;
    
    return formData;
}

//Insert the data
function insertNewRecord(data) {
    let table = document.getElementById("studentlist").getElementsByTagName('tbody')[0];
    let newRow = table.insertRow(table.length);
    cell1 = newRow.insertCell(0);
		cell1.innerHTML = data.productCode;
    cell2 = newRow.insertCell(1);
		cell2.innerHTML = data.product;
    cell5 = newRow.insertCell(2);
        cell5.innerHTML = `<button onClick="onEdit(this)">Edit</button> <button onClick="onDelete(this)">Delete</button>`;
}

//Edit the data
function onEdit(td) {
    selectedRow = td.parentElement.parentElement;
    document.getElementById("fn").value = selectedRow.cells[0].innerHTML;
    document.getElementById("ln").value = selectedRow.cells[1].innerHTML;
}
function updateRecord(formData) {
    selectedRow.cells[0].innerHTML = formData.productCode;
    selectedRow.cells[1].innerHTML = formData.product;  
    
}

//Delete the data
function onDelete(td) {
    if (confirm('Do you want to delete this record?')) {
        row = td.parentElement.parentElement;
        document.getElementById('studentlist').deleteRow(row.rowIndex);
    }
}

 function renderdata() 
 {
    if(isRender)
    { 
        console.log("hello")
           let table = document.getElementById("studentlist");
           let tbody = table.lastElementChild
           for (let i = 0; i < user.length; i++) 
           {
               tbody.innerHTML += `<tr><td>${user[i].firstname}</td><td>${user[i].lastname}</td><td><button onClick="onEdit(this)">Edit</button> <button onClick="onDelete(this)">Delete</button></td></tr>`;
           } 
    }
 }
</script>
</html>